"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[438],{3438:(U,m,s)=>{s.r(m),s.d(m,{SchoolAnalysisModule:()=>P});var c=s(9808),p=s(8581),f=s(1424),g=s(4119),r=s(4182),x=s(9441),t=s(2096),y=s(8388),S=s(2290),v=s(8965),u=s(778),A=s(9783),d=s(845);function T(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",10)(1,"form",11),t.NdJ("ngSubmit",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.reportForm.valid&&l.selectSchool())}),t._UZ(2,"p-dropdown",12),t.TgZ(3,"button",13),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.selectSchool())}),t.qZA()(),t.TgZ(4,"button",14),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return t.KtG(l.exportExcel())}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.reportForm),t.xp6(1),t.Q6J("options",e.schools)("filter",!0)}}function _(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"th",15)(2,"div",16),t._uU(3),t.qZA()(),t.BQk()),2&o){const e=n.$implicit;t.xp6(3),t.hij(" ",e," ")}}function b(o,n){if(1&o&&(t.TgZ(0,"tr")(1,"th",15)(2,"div",16),t._uU(3,"Student Level"),t.qZA()(),t.YNc(4,_,4,1,"ng-container",17),t.qZA()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.subjects)}}function C(o,n){if(1&o&&(t.TgZ(0,"tr")(1,"td",18)(2,"div",19),t._UZ(3,"button",20),t.TgZ(4,"span",21),t._uU(5),t.qZA()()()()),2&o){const e=n.$implicit,i=n.expanded;t.xp6(3),t.Q6J("pRowToggler",e)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.level)}}function Z(o,n){if(1&o&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&o){const e=t.oxw(2).$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.formatGrade(e.averageGrade),"% ")}}function F(o,n){1&o&&(t.TgZ(0,"td",23),t._uU(1,"0%"),t.qZA())}function w(o,n){if(1&o&&(t.ynx(0),t.YNc(1,Z,2,1,"td",22),t.YNc(2,F,2,0,"td",22),t.BQk()),2&o){const e=n.$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e==i.course),t.xp6(1),t.Q6J("ngIf",e!=i.course)}}function J(o,n){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.YNc(3,w,3,2,"ng-container",17),t.qZA()),2&o){const e=n.$implicit,i=t.oxw();t.xp6(2),t.hij(" ",e.level," "),t.xp6(1),t.Q6J("ngForOf",i.subjects)}}function M(o,n){1&o&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2,"No information found."),t.qZA()())}const N=function(){return[10,25,50]};let j=(()=>{class o{constructor(e,i,l,a){this.fb=e,this.reportService=i,this.toastService=l,this.busyService=a,this.allGrades=[],this.grades=[],this.schools=[],this.subjects=[]}initializeForm(){this.reportForm=this.fb.group({school:["",[r.kI.required]]})}ngOnInit(){this.getReportStatusUpdate(),this.initializeForm()}getReportStatusUpdate(){this.busyService.busy(),this.reportService.getGrades().subscribe(e=>{this.busyService.idle(),this.allGrades=e;let l=0;this.allGrades.forEach(a=>{this.schools.includes({name:a[0].organization,index:l})||this.schools.push({name:a[0].organization,index:l}),l++})},e=>{this.busyService.idle(),this.toastService.error("An error has occured please try again and report the issue if it persists","Error")})}selectSchool(){this.grades=this.allGrades[this.reportForm.controls.school.value.index],this.grades.forEach(e=>{this.subjects.includes(e.course)||this.subjects.push(e.course)})}formatGrade(e){return e.toFixed(2)}exportExcel(){s.e(574).then(s.bind(s,574)).then(e=>{const l={Sheets:{data:e.utils.json_to_sheet(this.grades)},SheetNames:["data"]},a=e.write(l,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(a,"products")})}saveAsExcelFile(e,i){const R=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});x.saveAs(R,i+"_export_"+(new Date).getTime()+".xlsx")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(y.r),t.Y36(S._W),t.Y36(v.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-school-analysis"]],decls:11,vars:6,consts:[[1,"content-container"],[1,"title-container"],[1,"text"],["styleClass","p-datatable-gridlines p-datatable-striped","dataKey","id","rowGroupMode","subheader","groupRowsBy","level","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","loading","paginator"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","groupheader"],["pTemplate","rowexpansion"],["pTemplate","emptymessage"],[1,"flex"],[1,"flex",3,"formGroup","ngSubmit"],["formControlName","school","optionLabel","name","placeholder","Organisation",3,"options","filter"],["type","button","pButton","","pRipple","","icon","pi pi-search","pTooltip","Select Organization","tooltipPosition","bottom",1,"p-button-info","mr-2",3,"click"],["type","button","pButton","","pRipple","","icon","pi pi-file-excel","pTooltip","XLS","tooltipPosition","bottom",1,"p-button-success","mr-2",3,"click"],[2,"min-width","15rem"],[1,"flex","align-items-center"],[4,"ngFor","ngForOf"],["colspan","5"],[1,"toggle"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain","mr-2",3,"pRowToggler","icon"],[1,"font-bold","ml-2"],["class","right",4,"ngIf"],[1,"right"],["colspan","7"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"School Analysis"),t.qZA()(),t.TgZ(4,"p-table",3,4),t.YNc(6,T,5,3,"ng-template",5),t.YNc(7,b,5,1,"ng-template",6),t.YNc(8,C,6,3,"ng-template",7),t.YNc(9,J,4,2,"ng-template",8),t.YNc(10,M,3,0,"ng-template",9),t.qZA()()),2&e&&(t.xp6(4),t.Q6J("value",i.grades)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(5,N))("paginator",!0))},dependencies:[c.sg,c.O5,u.Lt,A.jx,r._Y,r.JJ,r.JL,r.sg,r.u,p.iA,p.jB,d.Hq,g.u],styles:[".content-container[_ngcontent-%COMP%]{padding:0 2rem}.title-container[_ngcontent-%COMP%]{border-bottom:1px solid var(--light-gray);padding:1rem 0}.flex[_ngcontent-%COMP%]{gap:1rem;display:flex}.right[_ngcontent-%COMP%]{text-align:right!important}.toggle[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}"]}),o})();var h=s(8674);const O=[{path:"",component:j}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(O),h.Bz]}),o})(),P=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.ez,u.kW,r.UX,E,p.U$,d.hJ,f.j,g.z]}),o})()}}]);