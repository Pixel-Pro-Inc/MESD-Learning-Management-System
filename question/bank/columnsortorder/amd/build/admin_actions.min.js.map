{"version":3,"file":"admin_actions.min.js","sources":["../src/admin_actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for handling actions on the admin page\n *\n * @module     qbank_columnsortorder/admin_actions\n * @copyright  2023 onwards Catalyst IT Europe Ltd\n * @author     Mark Johnson <mark.johnson@catalyst-eu.net>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as actions from 'qbank_columnsortorder/actions';\nimport * as repository from 'qbank_columnsortorder/repository';\nimport Notification from \"core/notification\";\nimport Pending from 'core/pending';\n\n/**\n * Event handler to save the custom column widths when a field is edited.\n *\n * @param {Element} listRoot The root element of the list of columns.\n */\nconst setupSaveWidths = listRoot => {\n    listRoot.addEventListener('change', async() => {\n        const pendingPromise = new Pending('saveWidths');\n        const columns = listRoot.querySelectorAll(actions.SELECTORS.sortableColumn);\n        const widths = [];\n        columns.forEach(column => {\n            const widthInput = column.querySelector('.width-input');\n            const valid = widthInput.checkValidity();\n            widthInput.closest('.has-validation').classList.add('was-validated');\n            if (!valid) {\n                return;\n            }\n            widths.push({\n                column: column.dataset.columnid,\n                width: widthInput.value,\n            });\n        });\n        await repository.setColumnSize(JSON.stringify(widths), true).catch(Notification.exception);\n        pendingPromise.resolve();\n    });\n};\n\n/**\n * Initialize module\n *\n * Set up event handlers for the action buttons, width fields and initialise column sorting.\n *\n * @param {String} id ID for the admin UI root element.\n */\nexport const init = id => {\n    const uiRoot = document.getElementById(id);\n    const listRoot = uiRoot.querySelector(actions.SELECTORS.columnList);\n    actions.setupSortableLists(listRoot, true, true);\n    actions.setupActionButtons(uiRoot, true);\n    setupSaveWidths(listRoot);\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","_interopRequireWildcard","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","actions","repository","_notification","_pending","_exports","init","id","uiRoot","document","getElementById","listRoot","querySelector","SELECTORS","columnList","setupSortableLists","setupActionButtons","addEventListener","async","pendingPromise","Pending","columns","querySelectorAll","sortableColumn","widths","forEach","column","widthInput","valid","checkValidity","closest","classList","add","push","dataset","columnid","width","value","setColumnSize","JSON","stringify","catch","Notification","exception","resolve","setupSaveWidths"],"mappings":"6NA2BmC,SAAAA,uBAAAC,KAAAA,OAAAA,KAAAA,IAAAC,WAAAD,IAAAE,CAAAA,QAAAF,IAAA,CAAA,SAAAG,yBAAAC,GAAA,GAAA,mBAAAC,QAAA,OAAA,KAAA,IAAAC,EAAAD,IAAAA,QAAAE,EAAAF,IAAAA,eAAAF,yBAAA,SAAAC,GAAAA,OAAAA,EAAAG,EAAAD,IAAAF,EAAA,CAAA,SAAAI,wBAAAJ,EAAAE,GAAAA,IAAAA,GAAAF,GAAAA,EAAAH,kBAAAG,EAAA,GAAA,OAAAA,GAAA,iBAAAA,GAAA,mBAAAA,EAAA,MAAA,CAAAF,QAAAE,GAAA,IAAAG,EAAAJ,yBAAAG,GAAAC,GAAAA,GAAAA,EAAAE,IAAAL,GAAAG,OAAAA,EAAAG,IAAAN,GAAAO,IAAAA,GAAAC,UAAA,MAAAC,EAAAC,OAAAC,gBAAAD,OAAAE,yBAAA,IAAA,IAAAC,KAAAb,EAAA,GAAA,YAAAa,GAAAH,OAAAI,UAAAC,eAAAC,KAAAhB,EAAAa,GAAAI,CAAAA,IAAAA,EAAAR,EAAAC,OAAAE,yBAAAZ,EAAAa,GAAA,KAAAI,IAAAA,EAAAX,KAAAW,EAAAC,KAAAR,OAAAC,eAAAJ,EAAAM,EAAAI,GAAAV,EAAAM,GAAAb,EAAAa,EAAA,CAAA,OAAAN,EAAAT,QAAAE,EAAAG,GAAAA,EAAAe,IAAAlB,EAAAO,GAAAA;;;;;;;;KAAA,8EAHnCY,QAAAf,wBAAAe,SACAC,WAAAhB,wBAAAgB,YACAC,cAAA1B,uBAAA0B,eACAC,SAAA3B,uBAAA2B,UA0CEC,SAAAC,KANkBC,KAChB,MAAMC,OAASC,SAASC,eAAeH,IACjCI,SAAWH,OAAOI,cAAcX,QAAQY,UAAUC,YACxDb,QAAQc,mBAAmBJ,UAAU,GAAM,GAC3CV,QAAQe,mBAAmBR,QAAQ,GAjCfG,YACpBA,SAASM,iBAAiB,UAAUC,UAChC,MAAMC,eAAiB,IAAIC,SAAOxC,QAAC,cAC7ByC,QAAUV,SAASW,iBAAiBrB,QAAQY,UAAUU,gBACtDC,OAAS,GACfH,QAAQI,SAAQC,SACZ,MAAMC,WAAaD,OAAOd,cAAc,gBAClCgB,MAAQD,WAAWE,gBACzBF,WAAWG,QAAQ,mBAAmBC,UAAUC,IAAI,iBAC/CJ,OAGLJ,OAAOS,KAAK,CACRP,OAAQA,OAAOQ,QAAQC,SACvBC,MAAOT,WAAWU,OACpB,UAEAnC,WAAWoC,cAAcC,KAAKC,UAAUhB,SAAS,GAAMiB,MAAMC,cAAY9D,QAAC+D,WAChFxB,eAAeyB,SAAS,GAC1B,EAeFC,CAAgBlC,SAAS,CAC3B"}